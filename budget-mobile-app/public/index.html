<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Application de gestion budg√©taire personnelle"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <title>Budget Gestion</title>
    
    <!-- Script de nettoyage ultra-agressif pour √©liminer ERR_BLOCKED_BY_CLIENT -->
    <script>
      (function() {
        'use strict';
        
        // Liste des domaines de tracking √† bloquer
        const blockedDomains = [
          'play.google.com/log',
          'google-analytics.com',
          'googlesyndication.com',
          'doubleclick.net',
          'googleadservices.com',
          'googletagmanager.com',
          'google-analytics.com',
          'analytics.google.com'
        ];
        
        // Fonction pour v√©rifier si une URL doit √™tre bloqu√©e
        function shouldBlockUrl(url) {
          if (typeof url !== 'string') return false;
          return blockedDomains.some(domain => url.includes(domain));
        }
        
        // Bloquer console.error et console.warn pour les erreurs de tracking
        const originalError = console.error;
        const originalWarn = console.warn;
        const originalLog = console.log;
        
        console.error = function(...args) {
          const message = args.join(' ');
          if (!shouldBlockUrl(message) && !message.includes('ERR_BLOCKED_BY_CLIENT')) {
            originalError.apply(console, args);
          }
        };
        
        console.warn = function(...args) {
          const message = args.join(' ');
          if (!shouldBlockUrl(message) && !message.includes('ERR_BLOCKED_BY_CLIENT')) {
            originalWarn.apply(console, args);
          }
        };
        
        console.log = function(...args) {
          const message = args.join(' ');
          if (!shouldBlockUrl(message) && !message.includes('ERR_BLOCKED_BY_CLIENT')) {
            originalLog.apply(console, args);
          }
        };
        
        // Intercepter fetch
        const originalFetch = window.fetch;
        window.fetch = function(...args) {
          const url = args[0];
          if (shouldBlockUrl(url)) {
            console.log('Requ√™te de tracking bloqu√©e:', url);
            return Promise.resolve(new Response('', { 
              status: 200, 
              statusText: 'OK',
              headers: { 'Content-Type': 'text/plain' }
            }));
          }
          return originalFetch.apply(this, args);
        };
        
        // Intercepter XMLHttpRequest
        const originalXHROpen = XMLHttpRequest.prototype.open;
        const originalXHRSend = XMLHttpRequest.prototype.send;
        
        XMLHttpRequest.prototype.open = function(method, url, ...args) {
          if (shouldBlockUrl(url)) {
            this._blocked = true;
            this._blockedUrl = url;
            return originalXHROpen.call(this, 'GET', 'data:text/plain,', ...args);
          }
          this._blocked = false;
          return originalXHROpen.call(this, method, url, ...args);
        };
        
        XMLHttpRequest.prototype.send = function(...args) {
          if (this._blocked) {
            console.log('XHR de tracking bloqu√©:', this._blockedUrl);
            // Simuler une r√©ponse r√©ussie
            setTimeout(() => {
              if (this.onload) this.onload();
              if (this.onreadystatechange) this.onreadystatechange();
            }, 0);
            return;
          }
          return originalXHRSend.apply(this, args);
        };
        
        // Intercepter les requ√™tes d'images
        const originalImage = window.Image;
        window.Image = function() {
          const img = new originalImage();
          const originalSrc = Object.getOwnPropertyDescriptor(HTMLImageElement.prototype, 'src');
          
          Object.defineProperty(img, 'src', {
            set: function(value) {
              if (shouldBlockUrl(value)) {
                console.log('Image de tracking bloqu√©e:', value);
                return; // Ne pas d√©finir la source
              }
              originalSrc.set.call(this, value);
            },
            get: originalSrc.get
          });
          
          return img;
        };
        
        // Intercepter les scripts
        const originalCreateElement = document.createElement;
        document.createElement = function(tagName) {
          const element = originalCreateElement.call(document, tagName);
          
          if (tagName.toLowerCase() === 'script') {
            const originalSrc = Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype, 'src');
            
            Object.defineProperty(element, 'src', {
              set: function(value) {
                if (shouldBlockUrl(value)) {
                  console.log('Script de tracking bloqu√©:', value);
                  return; // Ne pas d√©finir la source
                }
                originalSrc.set.call(this, value);
              },
              get: originalSrc.get
            });
          }
          
          return element;
        };
        
        // Nettoyer les erreurs existantes
        window.addEventListener('error', function(e) {
          if (shouldBlockUrl(e.filename) || e.message.includes('ERR_BLOCKED_BY_CLIENT')) {
            e.preventDefault();
            e.stopPropagation();
            return false;
          }
        }, true);
        
        // Nettoyer les erreurs de promesses
        window.addEventListener('unhandledrejection', function(e) {
          if (e.reason && typeof e.reason === 'string' && shouldBlockUrl(e.reason)) {
            e.preventDefault();
            e.stopPropagation();
            return false;
          }
        });
        
        console.log('üõ°Ô∏è Protection anti-tracking activ√©e');
      })();
    </script>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
  </body>
</html> 